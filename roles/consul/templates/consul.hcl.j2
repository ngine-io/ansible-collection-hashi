# {{ ansible_managed }}
# Full configuration options can be found at https://www.consul.io/docs/agent/options.html

datacenter = "{{ consul__datacenter }}"
data_dir = "{{ consul__data_dir }}"
client_addr = "{{ ' '.join(consul__client_addresses) }}"
ui = {{'true' if consul__ui else 'false' }}
server = {{'true' if consul__role == 'server' else 'false' }}

{%- if consul__role == 'server' %}
bootstrap_expect = {{ consul__servers | count }}
{% endif -%}

{%- if consul__encrypt %}
encrypt = "{{ consul__encrypt }}"
{% endif -%}

retry_join = {{ consul__servers | to_json }}
log_level = "{{ consul__log_level }}"
node_name = "{{ consul__node_name }}"
bind_addr = "{{ consul__bind_address }}"
advertise_addr = "{{ consul__advertise_address }}"

{%- if consul__recursors %}
recursors = {{ consul__recursors | to_json }}
{% endif -%}
